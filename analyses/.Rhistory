quit()
library(gazer)
library(gazr)
quit()
citation("lme")
citation("lmer")
library(lme4)
citation(lme4)
citation("lme4")
citation("lmerTest")
quit()
library(lme4)
quit()
quit()
p = 4; # age, hearing ability, working memory ability
rxx = .4;
rxy = .2;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
p = 5; # age, hearing ability, working memory ability
rxx = .4;
rxy = .2;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
p = 4; # age, hearing ability, working memory ability
rxx = .4;
rxy = .2;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
install.packages("brms")
# Example 1 (found on Table 2 of Maxwell (2000))
rxx = .3;
source('~/Dropbox/work/funding/other PIs/McClannahan/R01 EMA Jan 2021 and Sept 2021/A1/based_on_Maxwell2000.R')
source('~/Dropbox/work/funding/other PIs/McClannahan/R01 EMA Jan 2021 and Sept 2021/A1/based_on_Maxwell2000.R')
p = 4; # age, hearing ability, working memory ability
rxx = .4;
rxy = .2;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
p = 4; # age, hearing ability, working memory ability
rxx = .4;
rxy = .25;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
p = 4; # age, hearing ability, working memory ability
rxx = .5;
rxy = .2;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
p = 4; # age, hearing ability, working memory ability
rxx = .45;
rxy = .2;
N = (7.85*(1+(p-1)*rxx-p*(rxy)^2)*(1 + (p-2)*rxx))/((rxy^2)*(1-rxx)) + p - 1
paste("Sample size for EMA: ", N)
(1800-1488)
(1800-1488)/1800
?cor
setwd("~/Dropbox/work/manuscripts/current_manuscripts/Rogers motion feedback/motion-feedback/analyses")
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(lme4)
library(lmerTest)
df <- read.csv("../data/motion_data.csv")
df <- df[df$x!=0,]
# add scan counter
df <- df %>% group_by(subject_number) %>% mutate(scan = row_number(subject_number))
# read in demographic data and add age, sex, age group to main df
dfp <- read.csv("../data/participants.csv")
head(dfp)
head(df)
# read in demographic data and add age, sex, age group to main df
dfp <- read.csv("../data/participants.csv")
head(dfp)
?inner_join
dfj <- left_join(df, dfp,
by = c("subject_number"),
keep = FALSE))
dfj <- left_join(df, dfp,
by = c("subject_number"),
keep = FALSE)
head(dfj)
dfj <- left_join(df, dfp,
by = c("subject_number", "FIRMM"),
keep = FALSE)
head(dfj)
write.table(dfj, file = "data_filtered.csv", sep=",", row.names = FALSE)
dfsubject <- summarize(group_by(df, subject_number),
FIRMM=mean(FIRMM),
meanFD=mean(FD),
medianFD=median(FD),
SDFD=sd(FD))
write.table(dfsubject, file = "data_by_subject.csv", sep =",", row.names = FALSE)
library(lme4)
library(lmerTest)
df <- read.csv("data_filtered.csv")
install.packages("nlme")
library(nlme)
m1 <- lme(FD ~ 1 + FIRMM,
data = df,
method = "ML")
m1 <- lme(FD ~ 1 + FIRMM,
random = 1 | subject,
data = df,
method = "ML")
m1 <- lme(FD ~ 1 + FIRMM,
random = 1 | run,
data = df,
method = "ML")
head(df)
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan,
data = df,
method = "ML")
df$FD
df <- df [!is.na(df$age_group),]
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan,
data = df,
method = "ML")
summary(m1)
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan,
data = df,
method = "ML",
control = cl_1,
correlation = corAR1())
?lme
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan,
data = df,
method = "ML",
correlation = corAR1())
summary(m1)
dfmean <- df %>%
group_by(FIRMM, scan) %>%
summarize(meanFD = mean(FD))
# hack for now to get rid of weird big number of scans
dfmean <- dfmean[dfmean$scan<800,]
ggplot(data = dfmean, aes(x = scan, y = meanFD, group = FIRMM, color = FIRMM)) +
geom_line()
library(ggplot2)
dfmean <- df %>%
group_by(FIRMM, scan) %>%
summarize(meanFD = mean(FD))
# hack for now to get rid of weird big number of scans
dfmean <- dfmean[dfmean$scan<800,]
ggplot(data = dfmean, aes(x = scan, y = meanFD, group = FIRMM, color = FIRMM)) +
geom_line()
dfmean <- df %>%
group_by(FIRMM, scan) %>%
summarize(meanFD = mean(FD))
library(tidyverse)
dfmean <- df %>%
group_by(FIRMM, scan) %>%
summarize(meanFD = mean(FD))
dfmean <- dfmean[dfmean$scan<800,]
ggplot(data = dfmean, aes(x = scan, y = meanFD, group = FIRMM, color = FIRMM)) +
geom_line()
cite(nlme)
cite("nlme")
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan,
data = df,
method = "ML",
correlation = corAR1(form = ~ scan | run))
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan + run,
data = df,
method = "ML",
correlation = corAR1())
m1 <- lme(FD ~ 1 + age_group * FIRMM,
random = ~1 | scan,
data = df,
method = "ML",
correlation = corAR1())
